[mesh]
Nx=64
Ny=256
xmin=0.0
xmax=4.0
ymin=0.0
ymax=4.0

[run]
tend=300.0
save_freq=1.0

boundaries_x=periodic
boundaries_y=reflecting


[solvers]
time_stepping=euler
riemann_solver=hllc
reconstruction=pcm_wb
CFL=0.3

[physics]
gamma0=1.66666667
problem=iso-thermal-triple
well_balanced_flux_at_y_bc=true

[gravity]
mode=constant
gy=20.0

[iso_three_layer]
dy0=1.0
dy1=1.0
dy2=2.0
theta1=10.0
theta2=4.0
k1=1.0
k2=2.5
m1=1.0
m2=4.0
rho0=10.0
T0=10.0

[heating]
active=true
mode=isothermal_cooling

[thermal_conduction]
active=true
kappa=0.07

bc_ymin=fixed_temperature
bc_ymax=fixed_gradient

bc_ymin_value=10.0
bc_ymax_value=4.0

conductivity_mode=iso-three

[viscosity]
active=true
mu=0.007

[misc]
log_frequency=1000
log_energy_contributions=false
log_energy_frequency=1